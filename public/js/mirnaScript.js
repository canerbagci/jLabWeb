function fillForm(){$.ajax({type:"GET",url:"http://10.2.30.139:3000/mirna/featList.txt",success:function(e){for(var t=e.split("\n"),n=[],o=[],l=[],a=[],r=[],c="",d=0;d<t.length-1;d++)r=t[d].split("	"),r[0]=r[0].replace(/\+/g,"plus"),c=r[1],c.indexOf("Sequential")>-1&&n.push(r[0]),c.indexOf("Structural")>-1&&o.push(r[0]),c.indexOf("Thermodynamic")>-1&&l.push(r[0]),c.indexOf("Probabilistic")>-1&&a.push(r[0]);for(var s=document.getElementById("seq"),d=0;d<n.length;d++){var i=document.createElement("option");i.innerHTML=n[d].replace(/plus/g,"+"),i.value=n[d],s.appendChild(i)}for(var s=document.getElementById("str"),d=0;d<o.length;d++){var i=document.createElement("option");i.innerHTML=o[d].replace(/plus/g,"+"),i.value=o[d],s.appendChild(i)}for(var s=document.getElementById("thermo"),d=0;d<l.length;d++){var i=document.createElement("option");i.innerHTML=l[d].replace(/plus/g,"+"),i.value=l[d],s.appendChild(i)}for(var s=document.getElementById("stat"),d=0;d<a.length;d++){var i=document.createElement("option");i.innerHTML=a[d].replace(/plus/g,"+"),i.value=a[d],s.appendChild(i)}},error:function(){console.log("File could not be retrieved")}})}function move(e,t){var n,o,l;for("seq"==t?"down"==e?(o=document.getElementById("seq"),l=document.getElementById("feat")):(o=document.getElementById("feat"),l=document.getElementById("seq")):"str"==t?"down"==e?(o=document.getElementById("str"),l=document.getElementById("feat")):(o=document.getElementById("feat"),l=document.getElementById("str")):"stat"==t?"down"==e?(o=document.getElementById("stat"),l=document.getElementById("feat")):(o=document.getElementById("feat"),l=document.getElementById("stat")):"thermo"==t&&("down"==e?(o=document.getElementById("thermo"),l=document.getElementById("feat")):(o=document.getElementById("feat"),l=document.getElementById("thermo"))),n=o.options.length;n--;)o.options[n].selected&&l.appendChild(o.options[n])}function selectAll(){selectBox=document.getElementById("feat");var e;for(e=selectBox.options.length;e--;)selectBox.options[e].selected=!0;var t=document.getElementById("hpl"),n=document.getElementById("sl");for(e=selectBox.options.length;e--;)if(!(selectBox.options[e].innerHTML.indexOf("dns")>-1)){if(t.checked){var o=document.createElement("option");o.innerHTML=selectBox.options[e].innerHTML+"/hpl",o.value=selectBox.options[e].value+"/hpl",o.selected=!0,selectBox.appendChild(o)}if(n.checked){var o=document.createElement("option");o.innerHTML=selectBox.options[e].innerHTML+"/sl",o.value=selectBox.options[e].value+"/sl",o.selected=!0,selectBox.appendChild(o)}}}function validateFasta(e){if(""==e)return!1;e=e.split("\n");for(var t="",n="",o=0,l=0;l<e.length;l++)if(console.log(e.length),0==e[l].indexOf(">"))o++,0===t.length&&(t=e[l]);else{if(!/^[AUGC\s]+$/i.test(e[l]))return console.log("not valid RNA sequence"),!1;n+=e[l]}return o>5?(console.log("you can run at most 5 sequences at a time"),!1):!0}$(document).ready(function(){fillForm(),$("#submit").click(function(){var e=$("#inputFasta").val(),t=$("#feat").val(),n=$("#email").val();if(""==e&&(e=$("#inputFasta").attr("placeholder")),0==validateFasta(e))$("#inputFasta").css("background-color","rgba(200,0,0,0.2)"),$("#resultDiv").append('<center><h4 style="color: red;">Please check your fasta input<h4><center>');else{var o=Math.floor(1e6*Math.random()+1e5),l={inputFasta:e,feat:encodeURI(t),email:n,runId:o};document.getElementById("mirnaForm").reset();var a=document.getElementById("feat");if(i=a.options.length,i<1)return $("#feat").css("background-color","rgba(200,0,0,0.2)"),$("#resultDiv").append('<center><h4 style="color: red;">Please select features that you want to calculate<h4><center>'),!1;if(""==n)return $("#email").css("background-color","rgba(200,0,0,0.2)"),$("#resultDiv").append('<center><h4 style="color: red;">Please provide an e-mail address<h4><center>'),!1;for(;i--;)a.options[i]=null;fillForm(),$("<div><center><h4><br><br>Your request has been queued with the ID:"+o+"<br>The results will be e-mailed to you after they are calculated.</h4></center></div>").appendTo("#resultDiv"),$.ajax({type:"POST",url:"/software/mirna/calcMirna",data:l,cache:!1,success:function(e){-1!=e.indexOf("success")?(console.log(e),$("<div><br></br><center><h4>Please go check your e-mail. Your calculation is done</center></h4></div>").appendTo("#resultDiv")):(console.log(e),$("<div><br></br><center><h4>"+e+"</center></h4></div>").appendTo("#resultDiv"))}})}return!1})});